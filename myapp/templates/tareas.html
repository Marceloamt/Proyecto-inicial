{% extends "base.html" %}

{% block title %}Tareas | HomeBalance{% endblock %}

{% block content %}
    <h2>🧹 Lista de Tareas del Hogar</h2>
    <p>Aquí podrás ver y asignar las tareas según disponibilidad.</p>

    <!-- Formulario para agregar una nueva tarea -->
    <form method="POST">
        {% csrf_token %}
        <input type="text" name="nombre" placeholder="Nombre de la tarea" required>
        <input type="text" name="responsable" placeholder="Responsable" required>
        <button type="submit">➕ Agregar tarea</button>
    </form>

    <hr>

    <!-- Lista de tareas reales desde la base de datos -->
    <ul>
        {% for tarea in tareas %}
            <section>
                {% if tarea.estado == "hecha" %}
                    ✅ <span style="color: gray; text-decoration: line-through;">
                        {{ tarea.nombre }} — {{ tarea.responsable }}
                    </span>
                    (<em>{{ tarea.estado }}</em>)
                    <form action="{% url 'completar_tarea' tarea.id %}" method="POST" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit">↩️ Marcar como pendiente</button>
                </form>
            {% else %}
                🕓 <span style="color: red;">
                    {{ tarea.nombre }} — {{ tarea.responsable }}
                </span>
                (<em>{{ tarea.estado }}</em>)
                <form action="{% url 'completar_tarea' tarea.id %}" method="POST" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit">
                        {% if tarea.estado == "pendiente" %}
                            ✅ Marcar como hecha
                        {% else %}
                            ↩️ Marcar como pendiente
                        {% endif %}
                    </button>
                </form>
            {% endif %}
            </section>
    {% empty %}
        <li>No hay tareas registradas aún 💤</li>
    {% endfor %}
</ul>
{% endblock %}